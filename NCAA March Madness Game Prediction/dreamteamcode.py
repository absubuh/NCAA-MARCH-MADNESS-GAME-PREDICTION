# -*- coding: utf-8 -*-
"""DreamTeamCode.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1SG0_1dBCJ4H60KM6ImYJhwvt-6xAhCb2
"""

import pandas as pd

df=pd.read_excel('/content/gameStats.xlsx')

homeDF=df[['Date','HomeTeam','AwayTeam','homePTS','awayPTS']].copy()
awayDF=df[['Date','AwayTeam','HomeTeam','awayPTS','homePTS']].copy()

homeDF.rename(columns={"HomeTeam":"Team","AwayTeam":"Opp","homePTS":"PTS","awayPTS":"OPPpts"},inplace=True)
awayDF.rename(columns={"AwayTeam":"Team","HomeTeam":"Opp","awayPTS":"PTS","homePTS":"OPPpts"},inplace=True)

homeDF['Home']=1
awayDF['Home']=0

allGames=pd.concat([homeDF,awayDF])

allGames['PD']=allGames['PTS']-allGames['OPPpts']
allGames['Win']=0
allGames['Win']=allGames['Win'].where(allGames['PD'] < 0, 1)

allGames.sort_values(by=['Team','Date'],inplace=True)

allGames['rowcount'] = allGames.groupby(['Team']).cumcount()+1

rollingWindow=3

allGames['TotalWins']=allGames['Win'].rolling(rollingWindow,closed='left').sum()
allGames['AvgPD']=allGames['PD'].rolling(rollingWindow,closed='left').mean()

allGames

allGames[allGames['rowcount'] > 3]